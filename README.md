# MoneyForward Asset Downloader

マネーフォワード ME の資産推移画面から、過去の資産データを一括で取得・CSVダウンロード・グラフ表示する Google Chrome 拡張機能です。
**v1.3.0 から、家計簿画面での一括カテゴリ設定機能が追加されました。**

![Version](https://img.shields.io/badge/version-1.3.3-blue.svg)

## ✨ 主な機能

### 1. 家計簿の一括カテゴリ設定 (New v1.3.0)
家計簿画面において、複数の明細を一括で編集できます。
- **一括選択**: 専用のチェックボックスで複数の行を選択。
- **カテゴリ一括適用**: 大項目・中項目を指定して、選択したすべての行に一括適用します。
- **安全な更新**: ドロップダウン操作をエミュレートし、確実に変更を保存します。
- **パネル移動**: パネルのヘッダーをドラッグすることで、画面上の好きな位置に移動できます。
- **プログレスバー表示 (New v1.3.3)**: 処理の進捗をバーで可視化し、完了時のポップアップを廃止しました。

### 2. 資産データの CSV 一括ダウンロード
- **全日次データ**: 過去の全データを月ごとに並列取得し、1つのCSVファイルとして保存します。
- **指定日抽出**: 「毎月25日（給料日）」や「毎月末」など、特定の日付のデータだけを抽出してCSV保存できます。
- **高速処理**: 並列リクエストにより、10年分のデータも数十秒で取得可能です。

### 3. 高機能なグラフ表示・分析
- **資産合計推移**: 資産総額の変動を太い折れ線グラフで直感的に把握できます。
- **内訳の積み上げ表示**: オプションで「預金・現金」「株式」「投資信託」などの内訳を積み上げグラフに切り替え可能です。
- **柔軟なフィルタリング (モーダル内操作)**:
  - **期間指定**: 過去1年 / 3年 / 5年 / 10年 / 全期間
  - **特定日抽出**: グラフを見ながら「毎月〇日」の条件を自由に変更・再描画できます。
- **保存・共有**:
  - **CSV保存**: 表示中のグラフデータ（フィルタリング済み）をCSVとしてダウンロードできます。
  - **画像コピー**: グラフを画像としてクリップボードにコピーします。
  - **データコピー**: Excel貼り付け用にタブ区切りテキストとしてコピーします。

### 4. テーマカラーのカスタマイズ
- **20種類のプリセット**: 「爽やかブルー」「シックダーク」「サンセットオレンジ」「桜色」など、多彩な20種類のテーマからドロップダウンで選ぶだけで瞬時に雰囲気を変更できます。
- **カラー変更機能**: カラーピッカーでお好みの色に微調整も可能です。
- **一括貼り付け**: 4色のカラーコードをテキストエリアに貼り付けるだけで、独自のテーマを適用できます。

## 📦 インストール方法

1. このリポジトリをクローンまたはダウンロードします。
2. Google Chrome を開き、アドレスバーに `chrome://extensions/` と入力します。
3. 右上の **「デベロッパーモード」** をオンにします。
4. **「パッケージ化されていない拡張機能を読み込む」** をクリックし、このプロジェクトのフォルダ（`SRC/moneyforward_extension`）を選択します。

## 🚀 使い方

### 家計簿を一括編集する場合
1. マネーフォワード ME の [家計簿画面](https://moneyforward.com/cf) にアクセスします。
2. 画面右下に「一括カテゴリ設定」パネルが表示されます（パネルはドラッグして移動可能です）。
3. **手動選択**: 表の左端に追加されたチェックボックスで対象を選択します。
4. パネルで大項目・中項目を選び、「選択した項目に適用」をクリックします。
5. 自動的にドロップダウンが操作され、カテゴリが更新されます（処理中はページを閉じないでください）。
6. 進捗がプログレスバーで表示され、完了するとステータスが表示されます。

### 資産データをダウンロード・分析する場合
1. マネーフォワード ME の [資産推移画面](https://moneyforward.com/bs/history) にアクセスします。
2. 画面右下に操作パネルが表示されます。
3. **CSVダウンロード**: 「全日次データをCSV保存」などをクリックします。
4. **グラフ分析**: 「グラフを表示・生成」をクリックし、モーダル画面で分析します。

## 🛠 技術スタック
- JavaScript (ES6+)
- Chart.js (グラフ描画)
- Chrome Extensions API (Manifest V3)

## 📂 ディレクトリ構成
```
moneyforward_extension/
├── assets/              # アイコン、ライブラリ(Chart.js)
├── content.js           # メインロジック（データ取得、UI生成、グラフ描画、家計簿操作）
├── manifest.json        # 拡張機能の設定ファイル
├── style.css            # UIデザイン (テーマカスタマイズ対応)
└── README.md            # 説明書
```

## 📝 License
MIT License

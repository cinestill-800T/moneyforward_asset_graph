# MoneyForward Asset Downloader

マネーフォワード ME の資産推移画面から、過去の資産データを一括で取得・CSVダウンロード・グラフ表示する Google Chrome 拡張機能です。

![Version](https://img.shields.io/badge/version-1.8-blue.svg)

## ✨ 主な機能

### 1. 資産データの CSV 一括ダウンロード
- **全日次データ**: 過去の全データを月ごとに並列取得し、1つのCSVファイルとして保存します。
- **指定日抽出**: 「毎月25日（給料日）」や「毎月末」など、特定の日付のデータだけを抽出してCSV保存できます。
- **高速処理**: 並列リクエストにより、10年分のデータも数十秒で取得可能です。

### 2. 高機能なグラフ表示・分析
- **資産合計推移**: 資産総額の変動を太い折れ線グラフで直感的に把握できます。
- **内訳の積み上げ表示**: オプションで「預金・現金」「株式」「投資信託」などの内訳を積み上げグラフに切り替え可能です。
- **柔軟なフィルタリング (モーダル内操作)**:
  - **期間指定**: 過去1年 / 3年 / 5年 / 10年 / 全期間
  - **特定日抽出**: グラフを見ながら「毎月〇日」の条件を自由に変更・再描画できます。
- **保存・共有**:
  - **CSV保存**: 表示中のグラフデータ（フィルタリング済み）をCSVとしてダウンロードできます。
  - **画像コピー**: グラフを画像としてクリップボードにコピーします。
  - **データコピー**: Excel貼り付け用にタブ区切りテキストとしてコピーします。

### 3. テーマカラーのカスタマイズ (New v1.8)
- **カラー変更機能**: 設定画面からお好みのテーマカラーに変更できます。
- **一括貼り付け**: 4色のカラーコードをテキストエリアに貼り付けるだけで、瞬時にテーマを適用できます。
- **プリセット**: 標準の「爽やかブルー」や「シックダーク」などのプリセットを用意しています。

## 📦 インストール方法

1. このリポジトリをクローンまたはダウンロードします。
2. Google Chrome を開き、アドレスバーに `chrome://extensions/` と入力します。
3. 右上の **「デベロッパーモード」** をオンにします。
4. **「パッケージ化されていない拡張機能を読み込む」** をクリックし、このプロジェクトのフォルダ（`SRC/moneyforward_extension`）を選択します。

## 🚀 使い方

1. マネーフォワード ME の [資産推移画面](https://moneyforward.com/bs/history) にアクセスします。
2. 画面右下に操作パネルが表示されます。

### CSVをサクッと欲しい場合
- **「全日次データをCSV保存」**: すべてのデータを保存します。
- **「指定日のみ抽出してCSV保存」**: 入力欄の日付（デフォルト25日）のデータだけを保存します。

### グラフで分析したい場合
- **「グラフを表示・生成」** をクリックします。
- 条件を指定して「再取得・描画」を押すとグラフが表示されます。
- 必要に応じて、グラフ右下のボタンから「CSV保存」や「画像コピー」を行ってください。

### テーマカラーを変更したい場合
- パネル右上の設定ボタン（歯車アイコン）をクリックします。
- カラーピッカーでお好みの色を選択するか、カラーコードを一括貼り付けしてください。
- 「保存して適用」を押すと変更が反映されます。

## 🛠 技術スタック
- JavaScript (ES6+)
- Chart.js (グラフ描画)
- Chrome Extensions API (Manifest V3)

## 📂 ディレクトリ構成
```
moneyforward_extension/
├── assets/              # アイコン、ライブラリ(Chart.js)
├── content.js           # メインロジック（データ取得、UI生成、グラフ描画）
├── manifest.json        # 拡張機能の設定ファイル
├── style.css            # UIデザイン (テーマカスタマイズ対応)
└── README.md            # 説明書
```

## 📝 License
MIT License
